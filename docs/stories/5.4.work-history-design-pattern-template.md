# Story 5.4: Work-History Design Pattern Template - Brownfield Addition

## Status
Ready for Implementation

## User Story

As a **UI/UX Developer** working on the Employee Management System,
I want **to create a standardized design pattern template based on the work-history page**,
So that **all employee dashboard pages follow consistent layout, interaction patterns, and user experience standards**.

## Story Context

**Existing System Integration:**

- Integrates with: Current work-history page (`/apps/web/src/app/dashboard/work-history/page.tsx`)
- Technology: Next.js 15 + TypeScript + Shadcn UI + Tailwind CSS
- Follows pattern: ProtectedRoute → Header → Container → Card-based content
- Touch points: Employee dashboard pages, admin reports, material management

## Acceptance Criteria

**Functional Requirements:**

1. **Design Pattern Documentation:**
   - Create comprehensive template based on work-history page structure
   - Document layout hierarchy: Header → Filter → Content → Empty States → Loading States
   - Define reusable component patterns for data display and interactions

2. **Template Component Creation:**
   - Create `PageTemplate` component following work-history structure
   - Build `DataCard` component based on TimeEntryCard patterns
   - Implement `EmptyStateTemplate` component for consistent empty states
   - Create `FilterTemplate` component for date/range filtering

3. **Pattern Application:**
   - Apply template to at least 2 existing employee dashboard pages
   - Ensure consistent spacing, typography, and interaction patterns
   - Maintain responsive behavior across mobile and desktop

**Integration Requirements:**

4. **Existing APIs remain unchanged** - No backend modifications required
5. **Work-history functionality continues to work unchanged** - Template enhances without breaking
6. **Integration with Shadcn design system maintains current behavior** - Uses existing components

**Quality Requirements:**

7. **Template is covered by component tests** - Unit tests for all template components
8. **Documentation includes usage examples** - Clear implementation guidelines
9. **No regression in existing functionality verified** - All dashboard pages work correctly

## Technical Notes

**Integration Approach:** Extract patterns from work-history page into reusable template components that can be applied to other dashboard pages

**Existing Pattern Reference:** 
- Work-history page structure: `apps/web/src/app/dashboard/work-history/page.tsx`
- TimeEntryCard component: `apps/web/src/components/employee/TimeEntryCard.tsx`
- EmptyStateMessage: `apps/web/src/components/employee/EmptyStateMessage.tsx`
- Loading and error patterns from WorkHistoryPage.tsx

**Key Constraints:** 
- Must maintain all existing functionality in work-history page
- Template should be generic enough for other dashboard pages
- Performance impact must be minimal (component reuse optimization)

## Definition of Done

- [ ] PageTemplate component created with work-history structure
- [ ] DataCard template component extracted from TimeEntryCard patterns
- [ ] EmptyStateTemplate component generalized from EmptyStateMessage
- [ ] FilterTemplate component created for consistent filtering UI
- [ ] Template applied to 2 existing dashboard pages successfully
- [ ] All existing functionality works without regression
- [ ] Component tests cover template functionality
- [ ] Documentation includes implementation examples
- [ ] Code follows existing patterns and TypeScript standards
- [ ] Mobile and desktop responsive behavior verified

## Implementation Details

### Work-History Pattern Analysis

**Layout Structure (Proven Pattern):**
```typescript
<ProtectedRoute allowedRoles={['employee']}>
  <div className="min-h-screen bg-gray-50 dark:bg-black">
    <EmployeeDashboardHeader />
    <div className="max-w-6xl mx-auto py-6 px-4 sm:px-6 lg:px-8 space-y-6">
      {/* Header Section */}
      <div className="flex justify-between items-center">
        <div>
          <h1 className="text-2xl font-bold text-gray-900">Page Title</h1>
          <p className="text-sm text-gray-600 mt-1">Page Description</p>
        </div>
        <Button>Action Button</Button>
      </div>
      
      {/* Filter Section */}
      <FilterComponent />
      
      {/* Content States */}
      {isLoading && <LoadingState />}
      {error && <ErrorState />}
      {!isLoading && !error && <ContentSection />}
    </div>
  </div>
</ProtectedRoute>
```

**Card Component Pattern (From TimeEntryCard):**
```typescript
<Card className="mb-3">
  <CardContent className="p-4">
    {/* Header with Badge */}
    <div className="flex justify-between items-start mb-2">
      <div className="flex-1">
        <div className="flex items-center gap-2 mb-1">
          <h3 className="font-medium text-sm">Title</h3>
          <Badge variant="default">Status</Badge>
        </div>
        <p className="text-sm text-muted-foreground">Subtitle</p>
      </div>
      <div className="text-right">Summary Info</div>
    </div>
    
    {/* Grid Content */}
    <div className="grid grid-cols-2 gap-4 text-sm">
      <div>
        <p className="text-muted-foreground">Label</p>
        <p className="font-medium">Value</p>
      </div>
    </div>
    
    {/* Action Button */}
    <div className="mt-3 pt-3 border-t">
      <Button variant="outline" size="sm" className="w-full">
        Action
      </Button>
    </div>
  </CardContent>
</Card>
```

**Empty State Pattern (From EmptyStateMessage):**
```typescript
<Card>
  <CardContent className="p-8 text-center">
    <div className="flex justify-center mb-4">
      <Icon className="h-12 w-12 text-muted-foreground/50" />
    </div>
    <h3 className="text-lg font-medium mb-2">Empty State Title</h3>
    <p className="text-muted-foreground">Primary Message</p>
    <p className="text-sm text-muted-foreground mt-2">Helper Text</p>
  </CardContent>
</Card>
```

### Components to Create

**1. PageTemplate Component:**
```typescript
interface PageTemplateProps {
  title: string
  description: string
  actionButton?: React.ReactNode
  filter?: React.ReactNode
  children: React.ReactNode
  isLoading?: boolean
  error?: string | null
  allowedRoles: ('employee' | 'admin')[]
}
```

**2. DataCard Template:**
```typescript
interface DataCardProps {
  title: string
  subtitle?: string
  badge?: { text: string; variant: 'default' | 'secondary' }
  summaryInfo?: string
  gridData: Array<{ label: string; value: string }>
  notes?: string
  action?: { label: string; onClick: () => void }
}
```

**3. EmptyStateTemplate:**
```typescript
interface EmptyStateTemplateProps {
  icon: React.ComponentType<{ className?: string }>
  title: string
  message: string
  helperText?: string
  action?: React.ReactNode
}
```

**4. FilterTemplate:**
```typescript
interface FilterTemplateProps {
  value: string
  onChange: (value: string) => void
  options: Array<{ value: string; label: string }>
  disabled?: boolean
}
```

### Target Pages for Template Application

**Primary Targets (After Template Creation):**
1. **Employee Material Usage Page** - Similar data display patterns
2. **Employee Sales Report Page** - Card-based data with filtering

**Secondary Targets (Future):**
1. Employee Profile/Settings page
2. Employee notifications/announcements page

### Testing Strategy

**Component Tests (Vitest + RTL):**
- PageTemplate renders all sections correctly
- DataCard displays data and handles interactions
- EmptyStateTemplate shows appropriate states
- FilterTemplate handles value changes

**Integration Tests:**
- Template application doesn't break existing pages
- Responsive behavior maintained
- Form integration works correctly

**E2E Tests (Playwright):**
- Work-history page functionality unchanged
- New template-based pages work correctly
- Mobile navigation and interactions

## Risk Mitigation

**Primary Risk:** Template abstraction might break existing work-history functionality
**Mitigation:** Extract template gradually, maintain work-history page unchanged, thorough testing
**Rollback Plan:** Revert to original work-history implementation, template is additive not replacement

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|---------|
| 2025-01-01 | 1.0 | Initial story creation from work-history analysis | Sarah (Product Owner) |

## Dev Agent Record

### Agent Model Used
Claude Sonnet 4 - Product Owner Agent

### Analysis Notes
- Work-history page demonstrates excellent Design System consistency
- TimeEntryCard shows perfect Shadcn component usage
- EmptyStateMessage provides great empty state UX
- Layout follows responsive-first principles
- Error handling and loading states are well implemented

### Priority Implementation Order
1. Extract PageTemplate from work-history structure
2. Create DataCard template based on TimeEntryCard
3. Generalize EmptyStateTemplate from EmptyStateMessage
4. Apply to material usage page (similar data patterns)
5. Document usage patterns for future pages

## QA Results
*To be populated after QA review*