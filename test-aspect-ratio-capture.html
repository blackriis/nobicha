<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏ö‡∏†‡∏≤‡∏û‡∏î‡πâ‡∏ß‡∏¢‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏™‡πà‡∏ß‡∏ô‡∏à‡∏£‡∏¥‡∏á</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
        }
        .container {
            text-align: center;
            margin-bottom: 20px;
        }
        video {
            border: 2px solid #3b82f6;
            border-radius: 20px;
            margin: 10px;
            background: #1f2937;
        }
        canvas {
            border: 2px solid #10b981;
            border-radius: 20px;
            margin: 10px;
        }
        button {
            padding: 10px 20px;
            margin: 5px;
            background: #3b82f6;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background: #2563eb;
        }
        .info {
            background: #f3f4f6;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            text-align: left;
        }
        .success {
            background: #ecfdf5;
            border: 1px solid #10b981;
        }
        .error {
            background: #fef2f2;
            border: 1px solid #ef4444;
        }
    </style>
</head>
<body>
    <h1>üéØ ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏ö‡∏†‡∏≤‡∏û‡∏î‡πâ‡∏ß‡∏¢‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏™‡πà‡∏ß‡∏ô‡∏à‡∏£‡∏¥‡∏á</h1>
    
    <div class="container">
        <button onclick="startCamera()">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏•‡πâ‡∏≠‡∏á</button>
        <button onclick="capturePhoto()">‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ</button>
        <button onclick="stopCamera()">‡∏´‡∏¢‡∏∏‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á</button>
    </div>

    <div class="container">
        <h3>üé• ‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡∏à‡∏≤‡∏Å‡∏Å‡∏•‡πâ‡∏≠‡∏á (‡πÑ‡∏°‡πà‡∏¢‡∏∑‡∏î)</h3>
        <video id="video" autoplay muted playsinline style="object-fit: contain; max-width: 300px; max-height: 400px;"></video>
        
        <h3>üì∏ ‡∏£‡∏π‡∏õ‡∏ó‡∏µ‡πà‡∏ñ‡πà‡∏≤‡∏¢ (‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏™‡πà‡∏ß‡∏ô‡∏à‡∏£‡∏¥‡∏á)</h3>
        <canvas id="canvas" style="max-width: 300px; max-height: 400px;"></canvas>
    </div>

    <div id="info" class="info">
        <strong>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ:</strong>
        <div id="technical-info">‡∏Å‡∏î‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏•‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</div>
    </div>

    <div id="result" class="info" style="display: none;">
        <strong>‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö:</strong>
        <div id="result-info"></div>
    </div>

    <script>
        let stream = null;
        let video = document.getElementById('video');
        let canvas = document.getElementById('canvas');
        let ctx = canvas.getContext('2d');

        async function startCamera() {
            try {
                // ‡∏Ç‡∏≠‡πÉ‡∏ä‡πâ‡∏Å‡∏•‡πâ‡∏≠‡∏á‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î - ‡πÉ‡∏´‡πâ‡∏Å‡∏•‡πâ‡∏≠‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°
                stream = await navigator.mediaDevices.getUserMedia({
                    video: {
                        facingMode: 'user', // ‡∏Å‡∏•‡πâ‡∏≠‡∏á‡∏´‡∏ô‡πâ‡∏≤
                        // ‡πÑ‡∏°‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î width/height ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÑ‡∏î‡πâ‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏™‡πà‡∏ß‡∏ô‡∏à‡∏£‡∏¥‡∏á
                    },
                    audio: false
                });

                video.srcObject = stream;
                
                video.onloadedmetadata = () => {
                    const videoWidth = video.videoWidth;
                    const videoHeight = video.videoHeight;
                    const aspectRatio = (videoWidth / videoHeight).toFixed(3);
                    
                    document.getElementById('technical-info').innerHTML = `
                        <strong>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠:</strong><br>
                        ‚Ä¢ ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á: ${videoWidth}px<br>
                        ‚Ä¢ ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á: ${videoHeight}px<br>
                        ‚Ä¢ ‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏™‡πà‡∏ß‡∏ô: ${aspectRatio} (${videoWidth}:${videoHeight})<br>
                        ‚Ä¢ ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó: ${videoWidth > videoHeight ? '‡πÅ‡∏ô‡∏ß‡∏ô‡∏≠‡∏ô (Landscape)' : '‡πÅ‡∏ô‡∏ß‡∏ï‡∏±‡πâ‡∏á (Portrait)'}<br>
                        <br>
                        <span style="color: #10b981; font-weight: bold;">‚úÖ ‡∏Å‡∏•‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß - ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏î‡∏†‡∏≤‡∏û</span>
                    `;
                };

            } catch (error) {
                console.error('‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏Å‡∏•‡πâ‡∏≠‡∏á:', error);
                document.getElementById('technical-info').innerHTML = `
                    <span style="color: #ef4444;">‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ${error.message}</span>
                `;
            }
        }

        function capturePhoto() {
            if (!stream || !video.videoWidth) {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏•‡πâ‡∏≠‡∏á‡∏Å‡πà‡∏≠‡∏ô');
                return;
            }

            // ‡πÉ‡∏ä‡πâ‡∏Ç‡∏ô‡∏≤‡∏î‡∏à‡∏£‡∏¥‡∏á‡∏Ç‡∏≠‡∏á‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠ - ‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏ô‡∏≤‡∏î‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
            const videoWidth = video.videoWidth;
            const videoHeight = video.videoHeight;
            
            canvas.width = videoWidth;
            canvas.height = videoHeight;

            // ‡∏ß‡∏≤‡∏î‡∏†‡∏≤‡∏û‡∏à‡∏≤‡∏Å‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡∏•‡∏á‡πÉ‡∏ô canvas ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ‡∏Ç‡∏ô‡∏≤‡∏î‡∏à‡∏£‡∏¥‡∏á
            ctx.drawImage(video, 0, 0, videoWidth, videoHeight);

            // ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö
            const aspectRatio = (videoWidth / videoHeight).toFixed(3);
            const isPortrait = videoHeight > videoWidth;
            
            document.getElementById('result').style.display = 'block';
            document.getElementById('result').className = 'info success';
            document.getElementById('result-info').innerHTML = `
                <strong>üìä ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏ö‡∏†‡∏≤‡∏û:</strong><br>
                ‚Ä¢ ‡∏Ç‡∏ô‡∏≤‡∏î‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ: ${videoWidth} √ó ${videoHeight}px<br>
                ‚Ä¢ ‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏™‡πà‡∏ß‡∏ô: ${aspectRatio}<br>
                ‚Ä¢ ‡∏Å‡∏≤‡∏£‡∏ß‡∏≤‡∏á‡πÅ‡∏ô‡∏ß: ${isPortrait ? '‡πÅ‡∏ô‡∏ß‡∏ï‡∏±‡πâ‡∏á' : '‡πÅ‡∏ô‡∏ß‡∏ô‡∏≠‡∏ô'}<br>
                ‚Ä¢ ‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏ü‡∏•‡πå: ${canvas.toDataURL('image/jpeg', 0.85).length} ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£ (Base64)<br>
                <br>
                <span style="color: #10b981; font-weight: bold;">
                    ‚úÖ ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏†‡∏≤‡∏û‡∏ñ‡∏π‡∏Å‡∏à‡∏±‡∏ö‡∏î‡πâ‡∏ß‡∏¢‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏™‡πà‡∏ß‡∏ô‡∏à‡∏£‡∏¥‡∏á‡∏Ç‡∏≠‡∏á‡∏Å‡∏•‡πâ‡∏≠‡∏á (‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏î)
                </span><br>
                <br>
                üí° <strong>‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢:</strong> ‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà‡∏à‡∏±‡∏ö‡πÑ‡∏î‡πâ‡∏à‡∏∞‡∏°‡∏µ‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏Å‡∏•‡πâ‡∏≠‡∏á‡∏™‡πà‡∏á‡∏°‡∏≤ 
                ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏ô‡∏≤‡∏î‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÑ‡∏ß‡πâ‡∏•‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤
            `;

            console.log('‡∏à‡∏±‡∏ö‡∏†‡∏≤‡∏û‡∏î‡πâ‡∏ß‡∏¢‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏™‡πà‡∏ß‡∏ô‡∏à‡∏£‡∏¥‡∏á:', {
                originalVideoSize: `${videoWidth}x${videoHeight}`,
                aspectRatio: aspectRatio,
                canvasSize: `${canvas.width}x${canvas.height}`,
                isStretched: false
            });
        }

        function stopCamera() {
            if (stream) {
                stream.getTracks().forEach(track => track.stop());
                stream = null;
                video.srcObject = null;
                
                // Clear canvas
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                document.getElementById('technical-info').innerHTML = '‡∏Å‡∏•‡πâ‡∏≠‡∏á‡∏ñ‡∏π‡∏Å‡∏´‡∏¢‡∏∏‡∏î‡πÅ‡∏•‡πâ‡∏ß';
                document.getElementById('result').style.display = 'none';
            }
        }

        // ‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö
        window.addEventListener('beforeunload', stopCamera);
    </script>

    <div class="info">
        <h3>üîç ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏´‡∏°‡πà:</h3>
        <ul>
            <li><strong>‡∏Å‡∏•‡πâ‡∏≠‡∏á:</strong> ‡∏à‡∏∞‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°‡πÄ‡∏≠‡∏á (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î)</li>
            <li><strong>‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠:</strong> ‡πÅ‡∏™‡∏î‡∏á‡∏î‡πâ‡∏ß‡∏¢ <code>object-fit: contain</code> (‡πÑ‡∏°‡πà‡∏¢‡∏∑‡∏î)</li>
            <li><strong>‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏ö‡∏†‡∏≤‡∏û:</strong> ‡πÉ‡∏ä‡πâ‡∏Ç‡∏ô‡∏≤‡∏î‡∏à‡∏£‡∏¥‡∏á‡∏Ç‡∏≠‡∏á‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠ (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö 640x480)</li>
            <li><strong>‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå:</strong> ‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏à‡∏∞‡∏°‡∏µ‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏Å‡∏•‡πâ‡∏≠‡∏á</li>
        </ul>
    </div>
</body>
</html>